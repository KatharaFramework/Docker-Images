FROM kathara/common:10
LABEL org.opencontainers.image.authors="Kathara Team <contact@kathara.org>"

RUN curl -s https://deb.frrouting.org/frr/keys.asc | apt-key add -   
   
RUN echo "deb https://deb.frrouting.org/frr $(lsb_release -s -c) \"frr-7\"" | tee -a /etc/apt/sources.list.d/frr.list 

ARG DEBIAN_FRONTEND="noninteractive"
RUN apt update && apt install -y frr frr-pythontools frr-rpki-rtrlib

RUN sed -i -e 's/service/no service/' /etc/frr/vtysh.conf \
&& rm /etc/frr/frr.conf

COPY su_frr.conf /etc/systemd/system/frr.service.d/su_frr.conf

RUN apt clean && \
    rm -rf /tmp/* /var/lib/apt/lists/* /var/tmp/*

